(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const g of s.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&l(g)}).observe(document,{childList:!0,subtree:!0});function h(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(i){if(i.ep)return;i.ep=!0;const s=h(i);fetch(i.href,s)}})();const t=document.getElementById("myCanvas"),n=t.getContext("2d"),b=document.getElementById("modal"),H=document.getElementById("closeModal");C();window.addEventListener("resize",C);function C(){window.innerWidth<820?(t.classList.add("hidden"),b.classList.remove("hidden")):(t.classList.remove("hidden"),b.classList.add("hidden"))}H.addEventListener("click",()=>{window.history.back()});let T=!1,x,k=0;const m=[0,0],u=12.8/100*t.height,w=1.5/100*t.width,d={x:t.width/6-u,y:(t.height-u)/2,color:"#FA40E4"},y={x:t.width-d.x-w,y:(t.height-u)/2,color:"#4EF349"},c=1.2/100*t.width,N="#D742F5";let a=t.width/2,f=t.height/2;function P(){const e="+-",r="234",h=e[Math.floor(Math.random()*e.length)],l=parseInt(r[Math.floor(Math.random()*3)],10);return h==="+"?l:-l}const o={dx:P(),dy:P()};let D=!1,L=!1,v=!1,E=!1;const W=setInterval(re,10);document.addEventListener("keydown",F,!1);document.addEventListener("keydown",Y,!1);document.addEventListener("keyup",q,!1);document.addEventListener("keydown",j,!1);document.addEventListener("keyup",z,!1);function F(e){(e.key==="g"||e.key==="Enter")&&(T=!0,x=new Date().getTime())}function I(){return o.dx<0?o.dx+=-.05:o.dx+=.05,o.dy>0?o.dy+=.05:o.dy+=-.05,o}function R(){(f+o.dy>t.height-c||f+o.dy<c)&&(o.dy=-o.dy)}function Y(e){e.key==="ArrowUp"?D=!0:e.key==="ArrowDown"&&(L=!0),(e.key==="ArrowUp"||e.key==="ArrowDown")&&e.preventDefault()}function q(e){e.key==="ArrowUp"?D=!1:e.key==="ArrowDown"&&(L=!1)}function j(e){e.key==="q"?v=!0:e.key==="w"&&(E=!0),(e.key==="q"||e.key==="w")&&e.preventDefault()}function z(e){e.key==="q"?v=!1:e.key==="w"&&(E=!1)}function M(e,r,h){h?(e.y+=7,e.y+u>t.height&&(e.y=t.height-u)):r&&(e.y+=-7,e.y<0&&(e.y=0))}function X(){M(d,v,E),M(y,D,L)}function G(){a-c<d.x+w&&a+c>d.x&&f>d.y&&f<d.y+u&&(o.dx=-o.dx,I(),f-c<d.y+u&&f+c>d.y&&a>d.x&&a<d.x+w&&(o.dy=-o.dy))}function J(){a+c>y.x&&a-c<y.x+w&&f>y.y&&f<y.y+u&&(o.dx=-o.dx,I(),f+c>y.y&&f-c<y.y+u&&a>y.x&&a<y.x+w&&(o.dy=-o.dy))}function K(){G(),J()}function U(){d.x=t.width/6-u,d.y=(t.height-u)/2,y.x=t.width-d.x-w,y.y=(t.height-u)/2}function B(){a=t.width/2,f=t.height/2,o.dx=P(),o.dy=P()}function A(e){m[e]+=1,T=!1,x=null}function Q(){(m[0]===5||m[1]===5)&&(k=0),a+o.dx<c?(A(1),B(),U()):a+o.dx>t.width-c&&(A(0),B(),U())}function V(){n.font="16px Arial",n.fillStyle="#eee",n.fillText("Player  1 :",28,40),n.fillText(m[0],38,60),n.fillText("Player 2 :",830,40),n.fillText(m[1],874,60)}function $(e){n.beginPath(),n.rect(e.x,e.y,w,u),n.fillStyle=e.color,n.fill(),n.closePath()}function Z(){n.beginPath(),n.arc(a,f,c,0,Math.PI*2),n.fillStyle=N,n.fill(),n.closePath()}function O(e){const r=Math.floor(e/60),h=Math.floor(e%60),l=Math.floor(e%1*100).toString().padStart(2,"0");return`${r}m${h<10?"0":""}${h}s${l}`}function _(){const e=O(k);n.beginPath(),n.font="24px Arial",n.fillStyle="#eee";const r="Time:",h=`${e}`,l=n.measureText(r).width,i=n.measureText(h).width,s=40,g=65,p=t.width/2-l/2,S=t.width/2-i/2;n.fillText(r,p,s),n.fillText(h,S,g),n.closePath()}function ee(){if(T){const e=new Date().getTime(),r=(e-x)/1e3;k+=r,x=e}}async function te(){try{return await(await fetch("/highscores")).json()}catch(e){return console.error("Error getting high scores:",e),[]}}async function ne(e){try{const r=await fetch("/highscores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});r.ok?console.log("Score added successfully."):console.error("Error adding score:",r.statusText)}catch(r){console.error("Error adding score:",r)}}function oe(){if(m[0]===5||m[1]===5){clearInterval(W);const e=O(k),r=m[0]===5?"Player 1":"Player 2";if(confirm(` ${r} WIN 
 YOU HELD ${e}!
 Do you want to enter your nickname in the Best Times table?`)===!0){let l=prompt("Your nickname here");l=l?l!="":"Anonyme",ne({nickname:l,time:e}).then(()=>(alert("Your time added successfully!"),te())).then(s=>{const g=s.map((p,S)=>`${S+1}. ${p.nickname} - ${p.time}`).join(`
`);alert(`Best Time:
${g}`),document.location.reload()}).catch(s=>{alert(s),document.location.reload()})}else document.location.reload()}}function re(){n.clearRect(0,0,t.width,t.height),$(y),$(d),Z(),R(),X(),K(),Q(),V(),ee(),_(),T&&(a+=o.dx,f+=o.dy),oe()}
